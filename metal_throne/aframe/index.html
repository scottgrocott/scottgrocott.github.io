
<!DOCTYPE html>
<html>
<head>
                  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EBGF4V165P"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EBGF4V165P');
</script>
  <meta charset="utf-8">
  <title>A-Frame Greybox Scene Build Date:2026-01-12 01:25:06</title>
  <!---->
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>

  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v7.0.0/dist/aframe-extras.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
    #loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-family: Arial, sans-serif;
      font-size: 24px;
      z-index: 1000;
      text-align: center;
    }
  </style>
</head>
<body>
  <style>
    /* Mobile Overlay Containers */
    #mobile-controls {
        position: fixed;
        bottom: 0; left: 0; width: 100%; height: 100%;
        pointer-events: none; /* Let touches pass through to joystick */
        z-index: 999;
        display: none; /* Show only on mobile via JS */
    }

     #joystick-container {
        position: fixed;
        bottom: 40px;
        left: 40px;
        width: 150px;
        height: 150px;
        z-index: 1001;
        /* Important: Ensure this doesn't block touch-to-look on the rest of the screen */
        touch-action: none;
    }
    .mobile-btn {
        position: fixed;
        width: 70px;
        height: 70px;
        border-radius: 50%;
        background: rgba(212, 106, 40, 0.4);
        border: 2px solid #d46a28;
        color: white;
        z-index: 1001;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    #btn-shoot { bottom: 120px; right: 40px; border-color: #a32e2e; background: rgba(163, 46, 46, 0.5); }
    #btn-interact { bottom: 40px; right: 40px; }

    /* Hide on desktop */
    @media (min-width: 992px) {
        #joystick-container, .mobile-btn { display: none; }
    }

    @media (max-width: 991px) { #mobile-controls { display: block; } }
</style>

<div id="mobile-controls">
    <div id="joystick-container"></div>
 <button id="btn-shoot" class="mobile-btn"><i class="bi bi-crosshair"></i></button>
<button id="btn-interact" class="mobile-btn"><i class="bi bi-hand-index-thumb"></i></button>
</div>  <div id="loading">Loading assets...</div>
  
  <a-scene movement-controls="controls: joystick; speed: 0.3>
    <!-- Sky -->
    <a-sky color="#87CEEB" radius="10000"></a-sky>
    
    <!-- Lighting -->
    <a-light type="ambient" color="#BBB"></a-light>
    <a-light type="directional" color="#FFF" intensity="0.6" position="1 1 0"></a-light>
    
    <!-- Ground plane -->
    <a-plane position="0 0 0" rotation="-90 0 0" width="10000" height="10000" color="tan" shadow></a-plane>
    
    <!-- Assets will be dynamically loaded here -->
    <a-assets id="asset-container" timeout="30000">
    </a-assets>
    
    <!-- Entities will be added here dynamically -->
    <a-entity id="scene-container"></a-entity>
    
    <!-- Camera with WASD controls -->
    <a-entity id="rig" position="0 1.6 0">
      <a-entity camera="far: 20000" look-controls="pointerLockEnabled: true" wasd-controls="acceleration: 100;fly: true" position="0 0 0"></a-entity>
    </a-entity>
  </a-scene>

  <script>
        const JSON_URL = 'https://scottgrocott.github.io/metal_throne/assets/json/greybox_assets_dev.json';
         
    async function loadScene() {
      try {
        const response = await fetch(JSON_URL);
        const data = await response.json();
        
        const assetContainer = document.querySelector('#asset-container');
        const sceneContainer = document.querySelector('#scene-container');
        
        // Load all model assets
        data.assets.forEach(asset => {
          const assetItem = document.createElement('a-asset-item');
          assetItem.setAttribute('id', asset.id);
          assetItem.setAttribute('src', asset.src);
          assetContainer.appendChild(assetItem);
        });
        
        // Wait for assets to load
        assetContainer.addEventListener('loaded', () => {
          document.querySelector('#loading').style.display = 'none';
        });
        
        // Create building entities
        data.buildings.forEach(building => {

          const entity = document.createElement('a-entity');
          entity.setAttribute('id', building.id);
          entity.setAttribute('gltf-model', building.model);
          // 1. Handle Position (Required)
          entity.setAttribute('position', building.position);

          // 2. Handle Scale (With Safety Default)
          // If scale is missing or is "0 0 0", default it to "1 1 1" 
          // so the object is actually visible.
          if (building.scale && building.scale !== "0 0 0") {
            entity.setAttribute('scale', building.scale);
          } else {
            entity.setAttribute('scale', '1 1 1'); 
          }

          // 3. Handle Rotation (With Safety Default)
          if (building.rotation) {
            entity.setAttribute('rotation', building.rotation);
          } else {
            entity.setAttribute('rotation', '0 0 0');
          }
          entity.setAttribute('class', building.class);
          sceneContainer.appendChild(entity);
        });
        
        // Create tank entities
        /*
        data.tanks.forEach((tank, index) => {
          const entity = document.createElement('a-entity');
          entity.setAttribute('id', `tank-${index}`);
          entity.setAttribute('geometry', tank.geometry);
          entity.setAttribute('material', tank.material);
          entity.setAttribute('scale', tank.scale);
          entity.setAttribute('position', tank.position);
          entity.setAttribute('class', tank.class);
          sceneContainer.appendChild(entity);
        });
        */
        console.log('Scene loaded successfully!');
        
      } catch (error) {
        console.error('Error loading scene:', error);
        document.querySelector('#loading').textContent = 'Error loading scene. Check console for details.';
      }
    }
    
    // Load the scene when the page loads
    window.addEventListener('load', loadScene);
  </script>
</body>
</html>